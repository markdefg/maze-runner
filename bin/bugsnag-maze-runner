#!/usr/bin/env ruby

puts 'In bugsnag-maze-runner'
if ARGV.include? "--version"
  require_relative '../lib/version'
  puts BugsnagMazeRunner::VERSION
  exit 0
elsif ARGV.include? "init"
  require_relative 'commands/init'
  exit 0
end

puts 'require cucumber'
require 'cucumber/cli/main'

directory = File.dirname(__FILE__)
puts "Expanding path: #{directory}"
CUKE_LOAD_DIR = File.expand_path(File.dirname(directory))

ENV['VERBOSE'] = "true" if ARGV.include? "--verbose"
args = ARGV.dup
args << "features" if args.empty?
# Load internal steps and helper functions
paths = Dir.glob("#{CUKE_LOAD_DIR}/lib/features/**/*.rb")
# Load project-specific steps and helper functions
paths += Dir.glob("features/{support,steps}/*.rb")
paths.each do |path|
  args << "-r"
  args << path
end

puts 'running cucumber with args'
puts args

Cucumber::Cli::Main.new(args).execute!
